---
title: 'Clerk'
description: 'Set up Clerk authentication for your Agentic Templates'
---

# Clerk Configuration

[Clerk](https://clerk.com) provides authentication, user management, and organization features for your Agentic Templates application.

## Setup Steps

1. Create a Clerk Account:
   - Go to [clerk.com](https://clerk.com)
   - Sign up for a new account
   - Create a new application

2. Configure Application Settings:
   - Choose "Next.js" as your framework
   - Set up your authentication strategies:
     - Email/Password
     - Social providers (Google, GitHub, etc.)
     - Passwordless options
   - Configure your sign-in and sign-up pages

3. Set up Organizations:
   - Enable Organizations in your Clerk Dashboard
   - Configure organization roles and permissions
   - Set up organization branding

## Environment Variables

### Landing Page (.env)
```bash
# Authentication
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
CLERK_SECRET_KEY=sk_test_...

# URLs
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/dashboard
```

### Dashboard (.env)
```bash
# Authentication
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
CLERK_SECRET_KEY=sk_test_...

# URLs (optional - if different from landing page)
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/auth/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/auth/sign-up
```

### API (.env)
```bash
# For JWT verification
CLERK_SECRET_KEY=sk_test_...
CLERK_JWT_VERIFICATION_KEY=your_verification_key
```

## Integration Features

1. **Authentication**:
   ```tsx
   // Protect pages/routes
   export default function Page() {
     return (
       <ClerkProvider>
         <SignedIn>
           <ProtectedContent />
         </SignedIn>
         <SignedOut>
           <RedirectToSignIn />
         </SignedOut>
       </ClerkProvider>
     );
   }
   ```

2. **User Management**:
   ```tsx
   // Access user data
   const { user } = useUser();
   const { firstName, lastName, primaryEmailAddress } = user;
   ```

3. **Organizations**:
   ```tsx
   // Organization context
   const { organization, membership } = useOrganization();
   const userRole = membership?.role;
   ```

## Webhook Configuration

1. Set up Clerk Webhooks:
   - Go to Webhooks in your Clerk Dashboard
   - Add your API endpoint URL: `https://api.yourdomain.com/webhooks/clerk`
   - Select events to monitor:
     - `user.created`
     - `user.updated`
     - `organization.created`
     - `organization.updated`

2. Configure Webhook Secret:
   ```bash
   # API .env
   CLERK_WEBHOOK_SECRET=whsec_...
   ```

3. Implement Webhook Handler:
   ```typescript
   // API webhook handler
   import { WebhookEvent } from '@clerk/nextjs/server';
   
   export async function POST(req: Request) {
     const evt = await req.json() as WebhookEvent;
     
     switch (evt.type) {
       case 'user.created':
         // Handle user creation
         break;
       case 'organization.created':
         // Handle org creation
         break;
     }
   }
   ```

## Custom Branding

1. Update Theme Settings:
   ```tsx
   <ClerkProvider
     appearance={{
       baseTheme: dark,
       variables: {
         colorPrimary: '#0D9373',
         colorTextOnPrimaryBackground: '#ffffff',
       },
       elements: {
         formButtonPrimary: {
           fontSize: '14px',
           textTransform: 'none',
           backgroundColor: '#0D9373',
         },
       },
     }}
   >
   ```

2. Custom Pages:
   - Create custom sign-in/sign-up pages
   - Use Clerk Components or Elements
   - Match your application's design

## Google Authentication

Clerk provides seamless integration with Google OAuth for user authentication. This allows users to sign up and sign in to your application using their Google accounts.

### Development Setup
For development environments, Clerk provides preconfigured OAuth credentials - no additional setup is required. Simply:

1. Navigate to the Clerk Dashboard's **SSO connections** page
2. Click **Add connection** and select **For all users**
3. Choose **Google** from the provider dropdown
4. Click **Add connection**

### Production Setup
For production environments, you'll need to configure custom credentials:

1. Enable Google connection in Clerk Dashboard
2. Create a Google Developer project and configure OAuth
3. Set up the Client ID and Secret in Clerk Dashboard

For detailed step-by-step instructions, refer to the [Google social connection guide](https://clerk.com/docs/authentication/social-connections/google#configure-for-your-production-instance).

Important considerations:
- Google OAuth does not support authentication via WebViews or in-app browsers
- For production, ensure your Google OAuth app's publishing status is set to "In production"
- Consider enabling email subaddress blocking for enhanced security

For complete configuration options and best practices, see the [Clerk Google authentication documentation](https://clerk.com/docs/authentication/social-connections/google).

## Best Practices

1. **Security**:
   - Enable MFA for sensitive operations
   - Use environment-specific keys
   - Implement proper CORS settings
   - Set up allowlist domains

2. **User Experience**:
   - Customize error messages
   - Add proper loading states
   - Implement progressive enhancement
   - Set up proper redirects

3. **Organization Management**:
   - Define clear role hierarchies
   - Set up proper permission scopes
   - Implement role-based access control

## Common Issues

### Authentication Flow
If users can't sign in:
1. Check Clerk Dashboard logs
2. Verify redirect URLs
3. Check CORS settings
4. Validate environment variables

### Webhook Issues
If webhooks aren't working:
1. Verify webhook secret
2. Check endpoint accessibility
3. Monitor webhook logs in Clerk Dashboard

### Organization Access
If organization access is denied:
1. Check user's role and permissions
2. Verify organization membership
3. Check organization settings

## Next Steps

- [Configure Unkey](/essentials/configuration/unkey)
- [Set up AWS](/essentials/configuration/aws)
- [Return to Quickstart](/quickstart) 